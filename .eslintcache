[{"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\serviceWorker.js":"1","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\counter\\counterSlice.js":"2","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\editor\\editorSlice.js":"3","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\editor\\Editor.js":"4","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\App.js":"5","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\app\\store.js":"6","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\streamATF.js":"7","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\textEditor.js":"8","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\atfRender.js":"9","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\fileTabs.js":"10","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\virtualizedTable.js":"11","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\appBar.js":"12","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\uploader.js":"13","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\index.js":"14","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\loaderSlice.js":"15","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\editor\\ChrComponent.js":"16","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\serviceWorker.js":"17","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\loaderSlice.js":"18","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\uploader.js":"19","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\editor\\ChrComponent.js":"20","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\fileTabs.js":"21","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\textEditor.js":"22","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\index.js":"23","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\app\\store.js":"24","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\editor\\Editor.js":"25","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\atfRender.js":"26","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\virtualizedTable.js":"27","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\appBar.js":"28","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\streamATF.js":"29"},{"size":5141,"mtime":1607079498037,"results":"30","hashOfConfig":"31"},{"size":1682,"mtime":1607096184908,"results":"32","hashOfConfig":"31"},{"size":2616,"mtime":1607864178694,"results":"33","hashOfConfig":"31"},{"size":9497,"mtime":1612031031680,"results":"34","hashOfConfig":"31"},{"size":1673,"mtime":1607448088633,"results":"35","hashOfConfig":"31"},{"size":388,"mtime":1607637621246,"results":"36","hashOfConfig":"31"},{"size":4597,"mtime":1611752233251,"results":"37","hashOfConfig":"31"},{"size":7373,"mtime":1611315741390,"results":"38","hashOfConfig":"31"},{"size":910,"mtime":1611052217471,"results":"39","hashOfConfig":"31"},{"size":1879,"mtime":1586917604731,"results":"40","hashOfConfig":"31"},{"size":9657,"mtime":1611923736551,"results":"41","hashOfConfig":"31"},{"size":4853,"mtime":1587600978661,"results":"42","hashOfConfig":"31"},{"size":18500,"mtime":1612020483808,"results":"43","hashOfConfig":"31"},{"size":761,"mtime":1609946069968,"results":"44","hashOfConfig":"31"},{"size":3028,"mtime":1612021116761,"results":"45","hashOfConfig":"31"},{"size":4672,"mtime":1612039899782,"results":"46","hashOfConfig":"31"},{"size":5141,"mtime":1607079498037,"results":"47","hashOfConfig":"48"},{"size":3028,"mtime":1612021116761,"results":"49","hashOfConfig":"48"},{"size":20668,"mtime":1615747474440,"results":"50","hashOfConfig":"48"},{"size":9384,"mtime":1615751389513,"results":"51","hashOfConfig":"48"},{"size":1879,"mtime":1586917604731,"results":"52","hashOfConfig":"48"},{"size":8253,"mtime":1614284283956,"results":"53","hashOfConfig":"48"},{"size":761,"mtime":1609946069968,"results":"54","hashOfConfig":"48"},{"size":388,"mtime":1607637621246,"results":"55","hashOfConfig":"48"},{"size":10912,"mtime":1615805860929,"results":"56","hashOfConfig":"48"},{"size":910,"mtime":1611052217471,"results":"57","hashOfConfig":"48"},{"size":9657,"mtime":1611923736551,"results":"58","hashOfConfig":"48"},{"size":4857,"mtime":1613670895812,"results":"59","hashOfConfig":"48"},{"size":4549,"mtime":1614288292567,"results":"60","hashOfConfig":"48"},{"filePath":"61","messages":"62","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"63"},"10l6qh8",{"filePath":"64","messages":"65","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"66"},{"filePath":"67","messages":"68","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"69","messages":"70","errorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"71","messages":"72","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"73","usedDeprecatedRules":"74"},{"filePath":"75","messages":"76","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"77"},{"filePath":"78","messages":"79","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"80"},{"filePath":"81","messages":"82","errorCount":0,"warningCount":15,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"83","messages":"84","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"85","messages":"86","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"87","usedDeprecatedRules":"88"},{"filePath":"89","messages":"90","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"91","messages":"92","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"74"},{"filePath":"93","messages":"94","errorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"95","messages":"96","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"77"},{"filePath":"97","messages":"98","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"99","messages":"100","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"101","messages":"102","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"103"},"17teegw",{"filePath":"104","messages":"105","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"106","usedDeprecatedRules":"103"},{"filePath":"107","messages":"108","errorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"109","messages":"110","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"111","messages":"112","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"113","messages":"114","errorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"115"},{"filePath":"116","messages":"117","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"118","messages":"119","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"120","messages":"121","errorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"122","messages":"123","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"124","messages":"125","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"126","messages":"127","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"128","messages":"129","errorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"130","usedDeprecatedRules":"103"},"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\serviceWorker.js",[],["131","132"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\counter\\counterSlice.js",[],["133","134"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\editor\\editorSlice.js",[],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\editor\\Editor.js",["135","136","137","138","139","140","141","142","143","144"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\App.js",["145","146"],"import React from 'react';\r\nimport logo from './logo.svg';\r\n//import { Counter } from './features/counter/Counter';\r\n\r\nimport { Editor } from './features/editor/Editor';\r\n\r\nimport { ATFUploader } from './features/loader/uploader';\r\n\r\nimport './App.css';\r\n\r\nfunction App() {\r\n    \r\n    return (\r\n    <div className=\"App\">\r\n    <ATFUploader/>\r\n    </div>\r\n    )\r\n/*   return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\r\n        <Editor />\r\n        <p>\r\n          Edit <code>src/App.js</code> and save to reload.\r\n        </p>\r\n        <span>\r\n          <span>Learn </span>\r\n          <a\r\n            className=\"App-link\"\r\n            href=\"https://reactjs.org/\"\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n          >\r\n            React\r\n          </a>\r\n          <span>, </span>\r\n          <a\r\n            className=\"App-link\"\r\n            href=\"https://redux.js.org/\"\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n          >\r\n            Redux\r\n          </a>\r\n          <span>, </span>\r\n          <a\r\n            className=\"App-link\"\r\n            href=\"https://redux-toolkit.js.org/\"\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n          >\r\n            Redux Toolkit\r\n          </a>\r\n          ,<span> and </span>\r\n          <a\r\n            className=\"App-link\"\r\n            href=\"https://react-redux.js.org/\"\r\n            target=\"_blank\"\r\n            rel=\"noopener noreferrer\"\r\n          >\r\n            React Redux\r\n          </a>\r\n        </span>\r\n      </header>\r\n    </div>\r\n  ); */\r\n}\r\n\r\nexport default App;\r\n",["147","148"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\app\\store.js",[],["149","150"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\streamATF.js",["151","152","153","154","155","156"],"import * as C from 'jtf-lib';\r\n\r\n//var DelimiterStream = require('delimiter-stream');\r\nvar StringDecoder = require('string_decoder').StringDecoder;\r\nvar decoder = new StringDecoder('utf8');\r\n//var toStream = require('blob-to-stream');\r\nconst {ReadableWebToNodeStream} = require('readable-web-to-node-stream');\r\n\r\n/* var es = require('event-stream');\r\nvar inspect = require('util').inspect;\r\n */\r\nvar _ = require('highland');\r\n\r\nconst chunk2TableData = (\r\n\tchunk, chunkDecoded, PNumber, linesCount, beginsAtLine, \r\n\tchunkStartsAt, chunkEndsAt, options) => {\r\n\t//\r\n\treturn {\r\n\t\t\t//string: chunkDecoded,\r\n\t\t\tPNumber: PNumber,\r\n\t\t\tchunkStartsAt: chunkStartsAt,\r\n\t\t\tchunkEndsAt: chunkStartsAt+chunk.length,\r\n\t\t\tbeginsAtLine: beginsAtLine,\r\n\t\t\tendsAtLine: beginsAtLine+linesCount,\r\n\t\t\t...options\r\n\t\t};\r\n};\r\n\r\nconst mapTextsInBuffer = function(arrBuff, offset, push, size) {\r\n\t//\r\n\tlet Uint8Arr = new Uint8Array(arrBuff);\r\n\tUint8Arr.forEach(function(x, i) {\r\n\t\tlet delim = [];\r\n\t\tif (offset+i===0) { //first line\r\n\t\t\tif (i+1 < Uint8Arr.length){\r\n\t\t\t\tdelim = Array.from(Uint8Arr.slice(i, i+2))\r\n\t\t\t}\r\n\t\t} else if (x===10) { //every new line\r\n\t\t\tif (i+2 < Uint8Arr.length){\r\n\t\t\t\ti++\r\n\t\t\t\tdelim = Array.from(Uint8Arr.slice(i, i+2))\r\n\t\t\t};\r\n\t\t};\r\n\t\tif (delim[0]===38 && delim[1]===80){ //i.e. '&P'\r\n\t\t\tpush(null, offset+i);\r\n\t\t};\r\n\t\tif (offset+i+1===size){ \r\n\t\t\tpush(null, _.nil)\r\n\t\t};\r\n\t});\r\n};\r\n\r\nconst file2textsMap = function(file) {\r\n\t//\r\n\treturn _(function (push, next) {\r\n\t\tlet size = file.size;\r\n\t\t//let delimiter = Buffer.from('\\n&P');\r\n\t\tlet last = false;\r\n\t\tlet fSlice = null;\r\n\t\tfor (let begin = 0; begin < size; begin+=100000){\r\n\t\t\tif (begin+100000 >= size ){\r\n\t\t\t\tlast = true\r\n\t\t\t\tfSlice = file.slice(begin, size)\r\n\t\t\t} else {\r\n\t\t\t\tfSlice = file.slice(begin, begin+100002);\r\n\t\t\t}\r\n\t\t\tfSlice.arrayBuffer()\r\n\t\t\t.then(\r\n\t\t\t\t(arrBuff) => {\r\n\t\t\t\t\tmapTextsInBuffer(arrBuff, begin, push, size);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\tif (last){ break };\r\n\t\t};\r\n\t});\r\n};\r\n\r\nexport const stream = (file, callback, callbackEnd) => {\r\n\t//\r\n\t//var input = toStream(file, { highWaterMark: 1024 }); //!!! This causes memory crash with large files\r\n\tconst input = new ReadableWebToNodeStream(file.stream());\r\n\tvar beginsAtLine = 1;\r\n\tvar chunksCounter = 0;\r\n\tvar fileTextsMap = [];\r\n\tvar delimiter = '\\n&P';\r\n\tvar splitter = file2textsMap(file); // that's a nodeJS stream\r\n\t\r\n\tsplitter.on('data', function(chunk) {\r\n\t\tsplitter.pause();\r\n\t\tfileTextsMap.push(chunk);\r\n\t\tchunksCounter++\r\n\t\tif (chunksCounter%1000===0){ \r\n\t\t\tconsole.log('so far:', chunksCounter)\r\n\t\t}\r\n\t\tsplitter.resume();\r\n\t});\r\n\t\r\n\tsplitter.on('end', () => {\r\n\t\tfileTextsMap.push(file.size);\r\n\t\tconsole.log('total:', chunksCounter);\r\n\t\tlet ATFMap = {\r\n\t\t\tfile: file,\r\n\t\t\tfileTextsMap: fileTextsMap,\r\n\t\t\ttextsCount: chunksCounter,\r\n\t\t};\r\n\t\tcallbackEnd( ATFActions2Map( ATFMap ) );\r\n\t});\r\n};\r\n\r\nexport const ATFActions2Map = function( map ){\r\n\t//\r\n\tlet { file, fileTextsMap, textsCount } = map;\r\n\tconsole.log('making ATF functions for file', file);\r\n\tconst getCoordinates = function(i){\r\n\t\t//\r\n\t\treturn [fileTextsMap[i], fileTextsMap[i+1]]\r\n\t};\r\n\t\r\n\tconst getTextObject = function(string, index){\r\n\t\t//\r\n\t\tlet getJTF = C.ATF2JTF.bind(this, string, map.file.name);\r\n\t\tconsole.log('! atf2jtf at index', index)\r\n\t\treturn {\r\n\t\t\tPNumber: string.slice(1, 8),\r\n\t\t\tstring: string,\r\n\t\t\t//map: map,\r\n\t\t\tindex: index,\r\n\t\t\tJTFResponse: getJTF(),\r\n\t\t};\r\n\t};\r\n\t\r\n\tconst ATFAtIndex = (index, callback=null) => {\r\n\t\t//\r\n\t\tconsole.log( 'requesting ATF at index', index )\r\n\t\tif (index<=textsCount){\r\n\t\t\tlet [start, end] = getCoordinates(index);\r\n\t\t\treturn file.slice(start, end).text().then(\r\n\t\t\t\t(string) => {\r\n\t\t\t\t\tlet atfObj = getTextObject(string, index)\r\n\t\t\t\t\tif (callback){\r\n\t\t\t\t\t\tcallback(atfObj)\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn atfObj;\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tif (callback){\r\n\t\t\t\tcallback(null);\r\n\t\t\t};\r\n\t\t\treturn null;\r\n\t\t};\r\n\t};\r\n\t\r\n\tconst arrToFile = (arr) => {\r\n\t\t//\r\n\t\tlet { name, webkitRelativePath, type } = file;\r\n\t\treturn new File(arr, name, {type: type,});\r\n\t};\r\n\t\r\n\tconst rewriteAtIndex = (index, string, callback, callbackEnd) => {\r\n\t\t// \r\n\t\tif (index<=textsCount){\r\n\t\t\tlet [start, end] = getCoordinates(index);\r\n\t\t\tlet first = file.slice(0, start);\r\n\t\t\tlet last = file.slice(end, file.size);\r\n\t\t\tPromise.resolve(first).then(first => {\r\n\t\t\t\tPromise.resolve(last).then(last => {\r\n\t\t\t\t\tlet newFile = arrToFile([first, string, last]);\r\n\t\t\t\t\tstream(newFile, callback, callbackEnd);\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t};\r\n\t};\r\n\t\r\n\tlet actions = { \r\n\t\t\tATFAtIndex: ATFAtIndex, \r\n\t\t\trewriteAtIndex: rewriteAtIndex,\r\n\t};\r\n\treturn {...map, actions: actions}\r\n};\r\n\r\n","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\textEditor.js",["157","158","159","160","161","162","163","164","165","166","167","168","169","170","171"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\atfRender.js",["172","173"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\fileTabs.js",["174","175"],"import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {Tab, Tabs, Typography, Box, AppBar, Zoom} from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nfunction TabPanel(props) {\r\n\tconst { children, value, index, ...other } = props;\r\n\r\n\treturn (\r\n\t\t<Typography\r\n\t\t\tcomponent=\"div\"\r\n\t\t\trole=\"tabpanel\"\r\n\t\t\thidden={value !== index}\r\n\t\t\tid={`scrollable-auto-tabpanel-${index}`}\r\n\t\t\taria-labelledby={`scrollable-auto-tab-${index}`}\r\n\t\t\t{...other}\r\n\t\t>\r\n\t\t\t{value === index && <Box p={3}>{children}</Box>}\r\n\t\t</Typography>\r\n\t);\r\n}\r\n\r\nTabPanel.propTypes = {\r\n\tchildren: PropTypes.node,\r\n\tindex: PropTypes.any.isRequired,\r\n\tvalue: PropTypes.any.isRequired,\r\n};\r\n\r\nfunction a11yProps(index) {\r\n\treturn {\r\n\t\tid: `scrollable-auto-tab-${index}`,\r\n\t\t'aria-controls': `scrollable-auto-tabpanel-${index}`,\r\n\t};\r\n}\r\n\r\nexport default class ScrollableTabsButtonAuto extends React.Component {\r\n\t// React component for uploading and checking ATF files.\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.tableRef = React.createRef()\r\n\t\tthis.state = {\r\n\t\t\tvalue: 0,\r\n\t\t};\r\n\t};\r\n\t\r\n\tmakeTabs = (tabsArr) => {\r\n\t\treturn tabsArr.map( (tab, i) => {\r\n\t\t\treturn this.makeTab(tab.label, i)\r\n\t\t});\r\n\t};\r\n\t\r\n\tmakeTab = (label, index) => {\r\n\t\treturn (\r\n\t\t\t<Tab\r\n\t\t\t\tkey={index}\r\n\t\t\t\tlabel={label}\r\n\t\t\t\t{...a11yProps(index)}\r\n\t\t\t/>)\r\n\t};\r\n\t\r\n\thandleChange = (event, newValue) => {\r\n\t\tthis.setState({value: newValue});\r\n\t\tthis.props.handleChangeCallback(newValue);\r\n\t};\r\n\t\r\n\trender(){\r\n\t\tlet { tabs } = this.props;\r\n\t\treturn (\r\n\t\t<AppBar position=\"static\" color=\"default\">\r\n\t\t\t<Tabs\r\n\t\t\t\tkey={0}\r\n\t\t\t\tvalue={this.state.value}\r\n\t\t\t\tindicatorColor=\"primary\"\r\n\t\t\t\ttextColor=\"primary\"\r\n\t\t\t\tvariant=\"scrollable\"\r\n\t\t\t\tscrollButtons=\"auto\"\r\n\t\t\t\taria-label=\"sources\"\r\n\t\t\t\tonChange={this.handleChange}\r\n\t\t\t>\r\n\t\t\t\t{this.makeTabs(tabs)}\r\n\t\t\t</Tabs>\r\n\t\t</AppBar>\r\n\t\t)\r\n\t};\r\n};\r\n",["176","177"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\virtualizedTable.js",["178","179","180","181","182"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\appBar.js",[],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\uploader.js",["183","184","185","186","187","188","189","190","191","192","193","194","195","196"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\index.js",[],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\loader\\loaderSlice.js",["197"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\UqNU\\uqnu\\src\\features\\editor\\ChrComponent.js",["198","199"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\serviceWorker.js",[],["200","201"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\loaderSlice.js",["202"],"import { createSlice } from '@reduxjs/toolkit';\r\n\r\nfunction logReducerData( message, state, action ){\r\n  //\r\n  console.log(message, JSON.parse(JSON.stringify(state)), action, action.payload)\r\n  console.log(state.JTF)\r\n};\r\n\r\nexport const loaderSlice = createSlice({\r\n  name: 'loader',\r\n  initialState: {\r\n    fileDataMap: {},\r\n    activeFileTab: 0,\r\n    activeTextRow: 0,\r\n    edit: null,\r\n    dropzoneDrawerOpen: false,\r\n    loadJTF: false,\r\n  },\r\n  reducers: {\r\n    // Redux Toolkit allows us to write \"mutating\" logic in reducers. It\r\n    // doesn't actually mutate the state because it uses the Immer library,\r\n    // which detects changes to a \"draft state\" and produces a brand new\r\n    // immutable state based off those changes.\r\n    // \r\n    updateDataMap: (state, action) => {\r\n    // onFileStreamEnd\r\n    // DO NOT STORE FILES IN redux\r\n    // https://stackoverflow.com/questions/61705940/best-way-to-store-file-objects-in-react-redux-store-files-upload-from-dropzone\r\n        let { key, data } = action.payload;\r\n        if ( data ){\r\n            state.fileDataMap[key] = data;\r\n        } else if (state.fileDataMap[key]) {\r\n            delete state.fileDataMap[key];\r\n        };\r\n    },\r\n    \r\n    loadJTFStart: (state, action) => {\r\n    // Mark JTF loading to editor as completed.\r\n        state.loadJTF = true;\r\n    },\r\n    loadJTFCompleted: (state, action) => {\r\n    // Mark JTF loading to editor as completed.\r\n        state.loadJTF = false;\r\n    },\r\n    openDropzoneDrawer: (state, action) => {\r\n     // onAddButtonClick\r\n    },\r\n    closeDropzoneDrawer: (state, action) => {\r\n    // closeDropzoneDrawer\r\n    },\r\n    handleDropzoneChangeStatus: (state, action) => {\r\n    // handleDropzoneChangeStatus\r\n    },\r\n    switchFileTab: (state, action) => {\r\n    // onFileTabSwitch\r\n        let { tab } = action.payload;\r\n        if (tab!==state.activeFileTab){\r\n            state.activeFileTab = tab;\r\n            state.activeTextRow = 0;\r\n            state.loadJTF = true;\r\n        };\r\n    },\r\n    selectTextRow: (state, action) => {\r\n    // onTextRowSelect\r\n        let { row } = action.payload;\r\n        if (row!==state.activeTextRow){\r\n            state.activeTextRow = row;\r\n            state.loadJTF = true;\r\n        };\r\n    },\r\n    editText: (state, action) => {\r\n    // onTextEdit\r\n    },\r\n    saveEdit2File: (state, action) => {\r\n    // saveEdit2File\r\n    },\r\n    download: (state, action) => {\r\n    // download\r\n    },\r\n    downloadFile: (state, action) => {\r\n    // downloadFile\r\n    },\r\n    downloadAllFiles: (state, action) => {\r\n    // downloadAllFiles\r\n    },\r\n    downloadCurrent: (state, action) => {\r\n    // downloadCurrent\r\n    },\r\n  },\r\n});\r\n\r\nexport const { \r\n  updateDataMap,\r\n  loadJTFStart,\r\n  loadJTFCompleted,\r\n  openDropzoneDrawer,\r\n  closeDropzoneDrawer,\r\n  handleDropzoneChangeStatus,\r\n  switchFileTab,\r\n  selectTextRow,\r\n  editText,\r\n  saveEdit2File,\r\n  download,\r\n  downloadFile,\r\n  downloadAllFiles,\r\n  downloadCurrent,\r\n  } = loaderSlice.actions;\r\n\r\nexport default loaderSlice.reducer;","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\uploader.js",["203","204","205","206","207","208","209","210","211","212","213"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\editor\\ChrComponent.js",["214"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\fileTabs.js",["215","216"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\textEditor.js",["217","218","219","220","221","222","223","224","225","226","227","228"],"import React from \"react\";\r\nimport { render } from \"react-dom\";\r\nimport AceEditor from \"react-ace\";\r\n \r\nimport \"ace-builds/src-noconflict/mode-java\";\r\nimport \"ace-builds/src-noconflict/theme-github\";\r\n\r\nimport { IconButton, Tooltip, Fab, Paper } from '@material-ui/core';\r\nimport StarIcon from '@material-ui/icons/Star';\r\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\r\nimport DoneIcon from '@material-ui/icons/Done';\r\nimport WarningIcon from '@material-ui/icons/Warning';\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\n\r\n// ToDo:\r\n// rewrite this with regard to Redux.\r\n// Esp. editing / saving functionality.\r\nimport { useSelector, useDispatch, connect, mapDispatchToProp } from 'react-redux';\r\n\r\nclass _ATFTextEditor extends React.Component {\r\n    // React component for uploading and checking ATF files.\r\n    constructor(props) {\r\n        super(props);\r\n        //ToDo: \r\n        // * move state to redux store level.\r\n        this.state = {\r\n            editor: null,\r\n            undoManager: null,\r\n            modified: false, \r\n            parentCalls: [],\r\n            value: (props.JTF && props.JTF.atf) ? props.JTF.atf : '',\r\n            annotations: [],\r\n        };\r\n    };\r\n    \r\n    componentDidUpdate( oldProps, oldState ) {\r\n        //\r\n        let { props } = this;\r\n        let value = (props.JTF && props.JTF.atf) \r\n            ? props.JTF.atf : '';\r\n        let oldValue = (oldProps.JTF && oldProps.JTF.atf) \r\n            ? oldProps.JTF.atf : '';\r\n        if ( value!==oldValue ){\r\n            this.setState({ value: value, modified: false })\r\n        };\r\n    };\r\n    \r\n/*     componentDidUpdate( oldProps, oldProps ) {\r\n        // \r\n        const newProps = this.props;\r\n        if (!newProps.content){\r\n            return;\r\n        };\r\n        if (this.state.modified \r\n            && newProps.index===oldProps.index){\r\n            this.updateFromEdit(newProps.edit);\r\n        } else {\r\n            Promise.resolve(newProps.content.rawATFobj)\r\n            .then( rawATFObj => {\r\n                this.updateFromObj(rawATFObj)\r\n            })\r\n        };\r\n    }; */\r\n    \r\n    onEditorLoad = ( editor ) => {\r\n        // Add editor and undoManager to state on load.\r\n        //console.log('loading editor');\r\n        let session = editor.getSession();\r\n        let undoManager = session.getUndoManager();\r\n        this.setState({\r\n            editor: editor,\r\n            undoManager: undoManager,\r\n        });\r\n    };\r\n    \r\n    onChange = ( newValue ) => {\r\n        // Callback on change of content in editor\r\n        let { value, parentCalls } = this.state;\r\n        let { onChange } = this.props;\r\n        if (parentCalls.length>0){\r\n            parentCalls.forEach(c => {\r\n                clearTimeout(c)\r\n            });\r\n        };\r\n        \r\n        if ( onChange ){\r\n            let callParent = setTimeout(onChange.bind(this, newValue, value), 3000);\r\n            this.setState({\r\n                modified: true,\r\n                value: newValue,\r\n                parentCalls: [callParent]\r\n            });\r\n        };\r\n    };\r\n    \r\n    updateFromEdit = ( JTFResponse ) => {\r\n        // Update this.state.value & .annotations from JTFResponse.\r\n        if (!JTFResponse){\r\n            return;\r\n        };\r\n        //let value = JTFResponse.data;\r\n        let {annotations} = this.state; \r\n        let newAnnotations = this.makeAnnotations(JTFResponse);\r\n        if (JSON.stringify(annotations)!==JSON.stringify(newAnnotations)){\r\n            this.setState({annotations: newAnnotations})\r\n        };\r\n        //this.updateIfNew(value, annotations);\r\n    };\r\n    \r\n    /*\r\n    updateFromObj = ( rawATFObj )=> {\r\n        // Update this.state.value & .annotations from rawATFObj.\r\n        if (!rawATFObj){\r\n            return;\r\n        };\r\n        this.updateIfNew(rawATFObj);\r\n    };\r\n    \r\n    updateIfNew = (rawATFObj) => {\r\n        //\r\n        //console.log('updating new');\r\n        let value = rawATFObj.string;\r\n        //console.log(value, this.state.value, this.state.value!==value)\r\n        if (this.state.value!==value) {\r\n            let PNumber = rawATFObj.PNumber;\r\n            let {file, texts} = rawATFObj.map;\r\n            let {name, size, lastModifiedDate} = file;\r\n            let annotations = this.makeAnnotations(rawATFObj.JTFResponse);\r\n            this.setState({\r\n                PNumber: PNumber,\r\n                name: name,\r\n                size: size,\r\n                lastModifiedDate: lastModifiedDate,\r\n                texts: texts,\r\n                value: value,\r\n                annotations: annotations,\r\n                modified: false,\r\n            });\r\n            this.resetUndoManager();\r\n        };\r\n    };\r\n    */\r\n    \r\n    resetUndoManager = () => {\r\n        // Reset undoManager after loading new content.\r\n        let {undoManager, editor} = this.state;\r\n        if (undoManager){\r\n            undoManager.reset();\r\n            let session = editor.getSession();\r\n            session.setUndoManager(undoManager)\r\n        };\r\n    };\r\n    \r\n    listExpectedClasses = (nearlyHints) => {\r\n        // \r\n        let expectedTokens = [];\r\n        if (nearlyHints){\r\n            expectedTokens = [...new Set(\r\n                Object.entries(nearlyHints)\r\n                .map(([key, obj]) => obj.token)\r\n            )].sort();\r\n        };\r\n        return expectedTokens;\r\n    };\r\n    \r\n    makeAnnotations = (JTFResponse) => {\r\n        // \r\n        let { errors } = JTFResponse;\r\n        return errors.map( error => {\r\n            let {agent, type, string, tokenValue, tokenClass, nearlyHints\r\n                } = error;\r\n            let errorText = agent+' '+type+' error.'\r\n            if (tokenValue && tokenClass){\r\n                errorText+='\\nToken: \"'+tokenValue+'\".\\nClass: '+tokenClass+'.'\r\n            };\r\n            let expectedClasses = this.listExpectedClasses(nearlyHints);\r\n            if (expectedClasses.length>0){\r\n                errorText+='\\nExpected classes: '+expectedClasses.join(', ')+'.'\r\n            }\r\n            return { \r\n                row: error.line-1,\r\n                column: error.column,\r\n                type: 'error',\r\n                text: errorText,\r\n            }\r\n        });\r\n    };\r\n    \r\n    renderEditor = () => {\r\n        //\r\n        let { data } = this.props;\r\n        let { value } = this.state;\r\n        let annotations = (data && data.JTF ) ? this.makeAnnotations(data.JTF) : [] ;\r\n        return (\r\n            <AceEditor\r\n                mode=\"java\"\r\n                theme=\"github\"\r\n                onChange={this.onChange}\r\n                onLoad={this.onEditorLoad}\r\n                name=\"UNIQUE_ID_OF_DIV\"\r\n                editorProps={{ $blockScrolling: true }}\r\n                setOptions={{ useWorker: false }}\r\n                value={value}\r\n                annotations={annotations}\r\n                showPrintMargin={false}\r\n                style={{width: '100%', height: `calc(100vh - 190px)`}}\r\n            />\r\n        );\r\n    };\r\n    \r\n    renderFAB = () => {\r\n        // floating action button.\r\n        let {modified, annotations} = this.state;\r\n        let {edit, save2file} = this.props;\r\n        let disabled = (annotations.length!==0 || (!modified && !edit));\r\n        return (\r\n            <Fab \r\n                color=\"primary\"\r\n                disabled={disabled}\r\n                size='small'\r\n                style={{\r\n                    float: 'right',\r\n                    marginTop: '-70px',\r\n                    marginRight: '50px',\r\n                    }}\r\n            >\r\n                <SaveIcon onClick={save2file}/>\r\n            </Fab>\r\n        );\r\n    };\r\n\r\n    render(){\r\n        // \r\n        //console.log('rendering editor');\r\n        return(\r\n            <Paper\r\n            elevation={1}\r\n            >\r\n                {/*{this.renderPanel()}*/}\r\n                {this.renderEditor()}\r\n                {this.renderFAB()}\r\n            </Paper>\r\n        );\r\n    };\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  //console.log( 'redux state:', state )\r\n  return {JTF: state.editor.JTF};\r\n};\r\nconst mapDispatchToProps = {};\r\nexport const ATFTextEditor = connect(mapStateToProps, mapDispatchToProps)(_ATFTextEditor)","C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\index.js",[],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\app\\store.js",[],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\editor\\Editor.js",["229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\atfRender.js",["246","247"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\virtualizedTable.js",["248","249","250","251","252"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\appBar.js",["253"],"C:\\Users\\Eli\\Desktop\\programmatical\\Cuneiform_and_ANE\\Cuneiform_processing\\uqnu\\uqnu\\src\\features\\loader\\streamATF.js",["254","255","256","257","258","259"],"import * as C from 'jtf-lib';\r\n\r\n//var DelimiterStream = require('delimiter-stream');\r\nvar StringDecoder = require('string_decoder').StringDecoder;\r\nvar decoder = new StringDecoder('utf8');\r\n//var toStream = require('blob-to-stream');\r\nconst {ReadableWebToNodeStream} = require('readable-web-to-node-stream');\r\n\r\n/* var es = require('event-stream');\r\nvar inspect = require('util').inspect;\r\n */\r\nvar _ = require('highland');\r\n\r\nconst chunk2TableData = (\r\n\tchunk, chunkDecoded, PNumber, linesCount, beginsAtLine, \r\n\tchunkStartsAt, chunkEndsAt, options) => {\r\n\t//\r\n\treturn {\r\n\t\t\t//string: chunkDecoded,\r\n\t\t\tPNumber: PNumber,\r\n\t\t\tchunkStartsAt: chunkStartsAt,\r\n\t\t\tchunkEndsAt: chunkStartsAt+chunk.length,\r\n\t\t\tbeginsAtLine: beginsAtLine,\r\n\t\t\tendsAtLine: beginsAtLine+linesCount,\r\n\t\t\t...options\r\n\t\t};\r\n};\r\n\r\nconst mapTextsInBuffer = function(arrBuff, offset, push, size) {\r\n\t//\r\n\tlet Uint8Arr = new Uint8Array(arrBuff);\r\n\tUint8Arr.forEach(function(x, i) {\r\n\t\tlet delim = [];\r\n\t\tif (offset+i===0) { //first line\r\n\t\t\tif (i+1 < Uint8Arr.length){\r\n\t\t\t\tdelim = Array.from(Uint8Arr.slice(i, i+2))\r\n\t\t\t}\r\n\t\t} else if (x===10) { //every new line\r\n\t\t\tif (i+2 < Uint8Arr.length){\r\n\t\t\t\ti++\r\n\t\t\t\tdelim = Array.from(Uint8Arr.slice(i, i+2))\r\n\t\t\t};\r\n\t\t};\r\n\t\tif (delim[0]===38 && delim[1]===80){ //i.e. '&P'\r\n\t\t\tpush(null, offset+i);\r\n\t\t};\r\n\t\tif (offset+i+1===size){ \r\n\t\t\tpush(null, _.nil)\r\n\t\t};\r\n\t});\r\n};\r\n\r\nconst file2textsMap = function(file) {\r\n\t//\r\n\treturn _(function (push, next) {\r\n\t\tlet size = file.size;\r\n\t\t//let delimiter = Buffer.from('\\n&P');\r\n\t\tlet last = false;\r\n\t\tlet fSlice = null;\r\n\t\tfor (let begin = 0; begin < size; begin+=100000){\r\n\t\t\tif (begin+100000 >= size ){\r\n\t\t\t\tlast = true\r\n\t\t\t\tfSlice = file.slice(begin, size)\r\n\t\t\t} else {\r\n\t\t\t\tfSlice = file.slice(begin, begin+100002);\r\n\t\t\t}\r\n\t\t\tfSlice.arrayBuffer()\r\n\t\t\t.then(\r\n\t\t\t\t(arrBuff) => {\r\n\t\t\t\t\tmapTextsInBuffer(arrBuff, begin, push, size);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\tif (last){ break };\r\n\t\t};\r\n\t});\r\n};\r\n\r\nexport const stream = (file, callback, callbackEnd) => {\r\n\t//\r\n\t//var input = toStream(file, { highWaterMark: 1024 }); //!!! This causes memory crash with large files\r\n\tconst input = new ReadableWebToNodeStream(file.stream());\r\n\tvar beginsAtLine = 1;\r\n\tvar chunksCounter = 0;\r\n\tvar fileTextsMap = [];\r\n\tvar delimiter = '\\n&P';\r\n\tvar splitter = file2textsMap(file); // that's a nodeJS stream\r\n\t\r\n\tsplitter.on('data', function(chunk) {\r\n\t\tsplitter.pause();\r\n\t\tfileTextsMap.push(chunk);\r\n\t\tchunksCounter++\r\n\t\tif (chunksCounter%1000===0){ \r\n\t\t\tconsole.log('so far:', chunksCounter)\r\n\t\t}\r\n\t\tsplitter.resume();\r\n\t});\r\n\t\r\n\tsplitter.on('end', () => {\r\n\t\tfileTextsMap.push(file.size);\r\n\t\t//console.log('total:', chunksCounter);\r\n\t\tlet ATFMap = {\r\n\t\t\tfile: file,\r\n\t\t\tfileTextsMap: fileTextsMap,\r\n\t\t\ttextsCount: chunksCounter,\r\n\t\t};\r\n\t\tcallbackEnd( ATFActions2Map( ATFMap ) );\r\n\t});\r\n};\r\n\r\nexport const ATFActions2Map = function( map ){\r\n\t//\r\n\tlet { file, fileTextsMap, textsCount } = map;\r\n\tconst getCoordinates = function(i){\r\n\t\t//\r\n\t\treturn [fileTextsMap[i], fileTextsMap[i+1]]\r\n\t};\r\n\t\r\n\tconst getTextObject = function(string, index){\r\n\t\t//\r\n\t\tlet getJTF = C.ATF2JTF.bind(this, string, map.file.name);\r\n\t\t//console.log('! atf2jtf at index', index)\r\n\t\treturn {\r\n\t\t\tPNumber: string.slice(1, 8),\r\n\t\t\tstring: string,\r\n\t\t\t//map: map,\r\n\t\t\tindex: index,\r\n\t\t\tJTFResponse: getJTF(),\r\n\t\t};\r\n\t};\r\n\t\r\n\tconst ATFAtIndex = (index, callback=null) => {\r\n\t\t//\r\n\t\t//console.log( 'requesting ATF at index', index )\r\n\t\tif (index<=textsCount){\r\n\t\t\tlet [start, end] = getCoordinates(index);\r\n\t\t\treturn file.slice(start, end).text().then(\r\n\t\t\t\t(string) => {\r\n\t\t\t\t\tlet atfObj = getTextObject(string, index)\r\n\t\t\t\t\tif (callback){\r\n\t\t\t\t\t\tcallback(atfObj)\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn atfObj;\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tif (callback){\r\n\t\t\t\tcallback(null);\r\n\t\t\t};\r\n\t\t\treturn null;\r\n\t\t};\r\n\t};\r\n\t\r\n\tconst arrToFile = (arr) => {\r\n\t\t//\r\n\t\tlet { name, webkitRelativePath, type } = file;\r\n\t\treturn new File(arr, name, {type: type,});\r\n\t};\r\n\t\r\n\tconst rewriteAtIndex = (index, string, callback, callbackEnd) => {\r\n\t\t// \r\n\t\tif (index<=textsCount){\r\n\t\t\tlet [start, end] = getCoordinates(index);\r\n\t\t\tlet first = file.slice(0, start);\r\n\t\t\tlet last = file.slice(end, file.size);\r\n\t\t\tPromise.resolve(first).then(first => {\r\n\t\t\t\tPromise.resolve(last).then(last => {\r\n\t\t\t\t\tlet newFile = arrToFile([first, string, last]);\r\n\t\t\t\t\tstream(newFile, callback, callbackEnd);\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t};\r\n\t};\r\n\t\r\n\tlet actions = { \r\n\t\t\tATFAtIndex: ATFAtIndex, \r\n\t\t\trewriteAtIndex: rewriteAtIndex,\r\n\t};\r\n\treturn {...map, actions: actions}\r\n};\r\n\r\n",{"ruleId":"260","replacedBy":"261"},{"ruleId":"262","replacedBy":"263"},{"ruleId":"260","replacedBy":"264"},{"ruleId":"262","replacedBy":"265"},{"ruleId":"266","severity":1,"message":"267","line":2,"column":45,"nodeType":"268","messageId":"269","endLine":2,"endColumn":62},{"ruleId":"266","severity":1,"message":"270","line":5,"column":3,"nodeType":"268","messageId":"269","endLine":5,"endColumn":11},{"ruleId":"266","severity":1,"message":"271","line":18,"column":8,"nodeType":"268","messageId":"269","endLine":18,"endColumn":18},{"ruleId":"266","severity":1,"message":"272","line":19,"column":8,"nodeType":"268","messageId":"269","endLine":19,"endColumn":22},{"ruleId":"266","severity":1,"message":"273","line":27,"column":10,"nodeType":"268","messageId":"269","endLine":27,"endColumn":25},{"ruleId":"266","severity":1,"message":"274","line":27,"column":27,"nodeType":"268","messageId":"269","endLine":27,"endColumn":45},{"ruleId":"275","severity":1,"message":"276","line":122,"column":42,"nodeType":"277","messageId":"278","endLine":122,"endColumn":44},{"ruleId":"266","severity":1,"message":"279","line":249,"column":11,"nodeType":"268","messageId":"269","endLine":249,"endColumn":17},{"ruleId":"280","severity":1,"message":"281","line":284,"column":8,"nodeType":"282","endLine":284,"endColumn":23},{"ruleId":"283","severity":1,"message":"284","line":322,"column":3,"nodeType":"285","messageId":"286","endLine":330,"endColumn":4},{"ruleId":"266","severity":1,"message":"287","line":2,"column":8,"nodeType":"268","messageId":"269","endLine":2,"endColumn":12},{"ruleId":"266","severity":1,"message":"288","line":5,"column":10,"nodeType":"268","messageId":"269","endLine":5,"endColumn":16},{"ruleId":"260","replacedBy":"289"},{"ruleId":"262","replacedBy":"290"},{"ruleId":"260","replacedBy":"291"},{"ruleId":"262","replacedBy":"292"},{"ruleId":"266","severity":1,"message":"293","line":5,"column":5,"nodeType":"268","messageId":"269","endLine":5,"endColumn":12},{"ruleId":"266","severity":1,"message":"294","line":14,"column":7,"nodeType":"268","messageId":"269","endLine":14,"endColumn":22},{"ruleId":"266","severity":1,"message":"295","line":81,"column":8,"nodeType":"268","messageId":"269","endLine":81,"endColumn":13},{"ruleId":"266","severity":1,"message":"296","line":82,"column":6,"nodeType":"268","messageId":"269","endLine":82,"endColumn":18},{"ruleId":"266","severity":1,"message":"297","line":85,"column":6,"nodeType":"268","messageId":"269","endLine":85,"endColumn":15},{"ruleId":"266","severity":1,"message":"298","line":156,"column":15,"nodeType":"268","messageId":"269","endLine":156,"endColumn":33},{"ruleId":"266","severity":1,"message":"299","line":2,"column":10,"nodeType":"268","messageId":"269","endLine":2,"endColumn":16},{"ruleId":"266","severity":1,"message":"271","line":8,"column":10,"nodeType":"268","messageId":"269","endLine":8,"endColumn":20},{"ruleId":"266","severity":1,"message":"300","line":8,"column":22,"nodeType":"268","messageId":"269","endLine":8,"endColumn":29},{"ruleId":"266","severity":1,"message":"301","line":9,"column":8,"nodeType":"268","messageId":"269","endLine":9,"endColumn":16},{"ruleId":"266","severity":1,"message":"302","line":10,"column":8,"nodeType":"268","messageId":"269","endLine":10,"endColumn":22},{"ruleId":"266","severity":1,"message":"303","line":11,"column":8,"nodeType":"268","messageId":"269","endLine":11,"endColumn":16},{"ruleId":"266","severity":1,"message":"304","line":12,"column":8,"nodeType":"268","messageId":"269","endLine":12,"endColumn":19},{"ruleId":"266","severity":1,"message":"305","line":13,"column":8,"nodeType":"268","messageId":"269","endLine":13,"endColumn":24},{"ruleId":"266","severity":1,"message":"306","line":77,"column":18,"nodeType":"268","messageId":"269","endLine":77,"endColumn":22},{"ruleId":"266","severity":1,"message":"307","line":166,"column":22,"nodeType":"268","messageId":"269","endLine":166,"endColumn":28},{"ruleId":"266","severity":1,"message":"308","line":188,"column":15,"nodeType":"268","messageId":"269","endLine":188,"endColumn":20},{"ruleId":"266","severity":1,"message":"309","line":216,"column":4,"nodeType":"268","messageId":"269","endLine":216,"endColumn":20},{"ruleId":"266","severity":1,"message":"310","line":218,"column":4,"nodeType":"268","messageId":"269","endLine":218,"endColumn":12},{"ruleId":"266","severity":1,"message":"311","line":219,"column":4,"nodeType":"268","messageId":"269","endLine":219,"endColumn":15},{"ruleId":"312","severity":1,"message":"313","line":254,"column":6,"nodeType":"314","endLine":256,"endColumn":9},{"ruleId":"266","severity":1,"message":"315","line":11,"column":13,"nodeType":"268","messageId":"269","endLine":11,"endColumn":14},{"ruleId":"266","severity":1,"message":"316","line":20,"column":6,"nodeType":"268","messageId":"269","endLine":20,"endColumn":14},{"ruleId":"266","severity":1,"message":"317","line":3,"column":45,"nodeType":"268","messageId":"269","endLine":3,"endColumn":49},{"ruleId":"266","severity":1,"message":"318","line":4,"column":10,"nodeType":"268","messageId":"269","endLine":4,"endColumn":20},{"ruleId":"260","replacedBy":"319"},{"ruleId":"262","replacedBy":"320"},{"ruleId":"266","severity":1,"message":"321","line":65,"column":7,"nodeType":"268","messageId":"269","endLine":65,"endColumn":17},{"ruleId":"266","severity":1,"message":"322","line":85,"column":7,"nodeType":"268","messageId":"269","endLine":85,"endColumn":19},{"ruleId":"323","severity":1,"message":"324","line":104,"column":5,"nodeType":"285","messageId":"325","endLine":106,"endColumn":6},{"ruleId":"266","severity":1,"message":"326","line":131,"column":31,"nodeType":"268","messageId":"269","endLine":131,"endColumn":38},{"ruleId":"323","severity":1,"message":"324","line":292,"column":5,"nodeType":"285","messageId":"325","endLine":294,"endColumn":6},{"ruleId":"266","severity":1,"message":"327","line":3,"column":13,"nodeType":"268","messageId":"269","endLine":3,"endColumn":14},{"ruleId":"266","severity":1,"message":"328","line":13,"column":35,"nodeType":"268","messageId":"269","endLine":13,"endColumn":39},{"ruleId":"266","severity":1,"message":"270","line":25,"column":3,"nodeType":"268","messageId":"269","endLine":25,"endColumn":11},{"ruleId":"266","severity":1,"message":"329","line":26,"column":3,"nodeType":"268","messageId":"269","endLine":26,"endColumn":9},{"ruleId":"266","severity":1,"message":"330","line":27,"column":3,"nodeType":"268","messageId":"269","endLine":27,"endColumn":6},{"ruleId":"266","severity":1,"message":"331","line":28,"column":3,"nodeType":"268","messageId":"269","endLine":28,"endColumn":9},{"ruleId":"266","severity":1,"message":"332","line":29,"column":3,"nodeType":"268","messageId":"269","endLine":29,"endColumn":7},{"ruleId":"266","severity":1,"message":"333","line":30,"column":3,"nodeType":"268","messageId":"269","endLine":30,"endColumn":7},{"ruleId":"266","severity":1,"message":"334","line":63,"column":5,"nodeType":"268","messageId":"269","endLine":63,"endColumn":19},{"ruleId":"266","severity":1,"message":"335","line":64,"column":5,"nodeType":"268","messageId":"269","endLine":64,"endColumn":23},{"ruleId":"266","severity":1,"message":"336","line":256,"column":30,"nodeType":"268","messageId":"269","endLine":256,"endColumn":43},{"ruleId":"266","severity":1,"message":"337","line":257,"column":13,"nodeType":"268","messageId":"269","endLine":257,"endColumn":19},{"ruleId":"266","severity":1,"message":"338","line":258,"column":15,"nodeType":"268","messageId":"269","endLine":258,"endColumn":23},{"ruleId":"266","severity":1,"message":"336","line":356,"column":30,"nodeType":"268","messageId":"269","endLine":356,"endColumn":43},{"ruleId":"266","severity":1,"message":"339","line":3,"column":10,"nodeType":"268","messageId":"269","endLine":3,"endColumn":24},{"ruleId":"323","severity":1,"message":"324","line":5,"column":3,"nodeType":"285","messageId":"325","endLine":7,"endColumn":4},{"ruleId":"340","severity":1,"message":"341","line":60,"column":25,"nodeType":"342","messageId":"343","endLine":60,"endColumn":26},{"ruleId":"260","replacedBy":"344"},{"ruleId":"262","replacedBy":"345"},{"ruleId":"266","severity":1,"message":"339","line":3,"column":10,"nodeType":"268","messageId":"269","endLine":3,"endColumn":24},{"ruleId":"266","severity":1,"message":"327","line":3,"column":13,"nodeType":"268","messageId":"269","endLine":3,"endColumn":14},{"ruleId":"266","severity":1,"message":"270","line":28,"column":3,"nodeType":"268","messageId":"269","endLine":28,"endColumn":11},{"ruleId":"266","severity":1,"message":"329","line":29,"column":3,"nodeType":"268","messageId":"269","endLine":29,"endColumn":9},{"ruleId":"266","severity":1,"message":"330","line":30,"column":3,"nodeType":"268","messageId":"269","endLine":30,"endColumn":6},{"ruleId":"266","severity":1,"message":"331","line":31,"column":3,"nodeType":"268","messageId":"269","endLine":31,"endColumn":9},{"ruleId":"266","severity":1,"message":"332","line":32,"column":3,"nodeType":"268","messageId":"269","endLine":32,"endColumn":7},{"ruleId":"266","severity":1,"message":"333","line":33,"column":3,"nodeType":"268","messageId":"269","endLine":33,"endColumn":7},{"ruleId":"266","severity":1,"message":"335","line":63,"column":5,"nodeType":"268","messageId":"269","endLine":63,"endColumn":23},{"ruleId":"266","severity":1,"message":"306","line":201,"column":30,"nodeType":"268","messageId":"269","endLine":201,"endColumn":34},{"ruleId":"266","severity":1,"message":"336","line":363,"column":30,"nodeType":"268","messageId":"269","endLine":363,"endColumn":43},{"ruleId":"266","severity":1,"message":"346","line":497,"column":21,"nodeType":"268","messageId":"269","endLine":497,"endColumn":25},{"ruleId":"266","severity":1,"message":"347","line":1,"column":28,"nodeType":"268","messageId":"269","endLine":1,"endColumn":36},{"ruleId":"266","severity":1,"message":"317","line":3,"column":45,"nodeType":"268","messageId":"269","endLine":3,"endColumn":49},{"ruleId":"266","severity":1,"message":"318","line":4,"column":10,"nodeType":"268","messageId":"269","endLine":4,"endColumn":20},{"ruleId":"266","severity":1,"message":"299","line":2,"column":10,"nodeType":"268","messageId":"269","endLine":2,"endColumn":16},{"ruleId":"266","severity":1,"message":"271","line":8,"column":10,"nodeType":"268","messageId":"269","endLine":8,"endColumn":20},{"ruleId":"266","severity":1,"message":"300","line":8,"column":22,"nodeType":"268","messageId":"269","endLine":8,"endColumn":29},{"ruleId":"266","severity":1,"message":"301","line":9,"column":8,"nodeType":"268","messageId":"269","endLine":9,"endColumn":16},{"ruleId":"266","severity":1,"message":"302","line":10,"column":8,"nodeType":"268","messageId":"269","endLine":10,"endColumn":22},{"ruleId":"266","severity":1,"message":"303","line":11,"column":8,"nodeType":"268","messageId":"269","endLine":11,"endColumn":16},{"ruleId":"266","severity":1,"message":"304","line":12,"column":8,"nodeType":"268","messageId":"269","endLine":12,"endColumn":19},{"ruleId":"266","severity":1,"message":"305","line":13,"column":8,"nodeType":"268","messageId":"269","endLine":13,"endColumn":24},{"ruleId":"266","severity":1,"message":"348","line":19,"column":10,"nodeType":"268","messageId":"269","endLine":19,"endColumn":21},{"ruleId":"266","severity":1,"message":"349","line":19,"column":23,"nodeType":"268","messageId":"269","endLine":19,"endColumn":34},{"ruleId":"266","severity":1,"message":"267","line":19,"column":45,"nodeType":"268","messageId":"269","endLine":19,"endColumn":62},{"ruleId":"266","severity":1,"message":"307","line":171,"column":31,"nodeType":"268","messageId":"269","endLine":171,"endColumn":37},{"ruleId":"266","severity":1,"message":"267","line":2,"column":45,"nodeType":"268","messageId":"269","endLine":2,"endColumn":62},{"ruleId":"266","severity":1,"message":"270","line":5,"column":3,"nodeType":"268","messageId":"269","endLine":5,"endColumn":11},{"ruleId":"266","severity":1,"message":"329","line":6,"column":3,"nodeType":"268","messageId":"269","endLine":6,"endColumn":9},{"ruleId":"266","severity":1,"message":"330","line":7,"column":3,"nodeType":"268","messageId":"269","endLine":7,"endColumn":6},{"ruleId":"266","severity":1,"message":"331","line":8,"column":3,"nodeType":"268","messageId":"269","endLine":8,"endColumn":9},{"ruleId":"266","severity":1,"message":"332","line":9,"column":3,"nodeType":"268","messageId":"269","endLine":9,"endColumn":7},{"ruleId":"266","severity":1,"message":"333","line":10,"column":3,"nodeType":"268","messageId":"269","endLine":10,"endColumn":7},{"ruleId":"266","severity":1,"message":"350","line":13,"column":15,"nodeType":"268","messageId":"269","endLine":13,"endColumn":27},{"ruleId":"266","severity":1,"message":"271","line":18,"column":8,"nodeType":"268","messageId":"269","endLine":18,"endColumn":18},{"ruleId":"266","severity":1,"message":"272","line":19,"column":8,"nodeType":"268","messageId":"269","endLine":19,"endColumn":22},{"ruleId":"266","severity":1,"message":"351","line":25,"column":9,"nodeType":"268","messageId":"269","endLine":25,"endColumn":16},{"ruleId":"266","severity":1,"message":"352","line":26,"column":9,"nodeType":"268","messageId":"269","endLine":26,"endColumn":17},{"ruleId":"266","severity":1,"message":"273","line":27,"column":10,"nodeType":"268","messageId":"269","endLine":27,"endColumn":25},{"ruleId":"266","severity":1,"message":"274","line":27,"column":27,"nodeType":"268","messageId":"269","endLine":27,"endColumn":45},{"ruleId":"275","severity":1,"message":"276","line":164,"column":42,"nodeType":"277","messageId":"278","endLine":164,"endColumn":44},{"ruleId":"266","severity":1,"message":"279","line":277,"column":46,"nodeType":"268","messageId":"269","endLine":277,"endColumn":52},{"ruleId":"280","severity":1,"message":"281","line":315,"column":8,"nodeType":"282","endLine":315,"endColumn":23},{"ruleId":"266","severity":1,"message":"315","line":11,"column":13,"nodeType":"268","messageId":"269","endLine":11,"endColumn":14},{"ruleId":"266","severity":1,"message":"316","line":20,"column":6,"nodeType":"268","messageId":"269","endLine":20,"endColumn":14},{"ruleId":"266","severity":1,"message":"321","line":65,"column":7,"nodeType":"268","messageId":"269","endLine":65,"endColumn":17},{"ruleId":"266","severity":1,"message":"322","line":85,"column":7,"nodeType":"268","messageId":"269","endLine":85,"endColumn":19},{"ruleId":"323","severity":1,"message":"324","line":104,"column":5,"nodeType":"285","messageId":"325","endLine":106,"endColumn":6},{"ruleId":"266","severity":1,"message":"326","line":131,"column":31,"nodeType":"268","messageId":"269","endLine":131,"endColumn":38},{"ruleId":"323","severity":1,"message":"324","line":292,"column":5,"nodeType":"285","messageId":"325","endLine":294,"endColumn":6},{"ruleId":"266","severity":1,"message":"353","line":187,"column":7,"nodeType":"268","messageId":"269","endLine":187,"endColumn":17},{"ruleId":"266","severity":1,"message":"293","line":5,"column":5,"nodeType":"268","messageId":"269","endLine":5,"endColumn":12},{"ruleId":"266","severity":1,"message":"294","line":14,"column":7,"nodeType":"268","messageId":"269","endLine":14,"endColumn":22},{"ruleId":"266","severity":1,"message":"295","line":81,"column":8,"nodeType":"268","messageId":"269","endLine":81,"endColumn":13},{"ruleId":"266","severity":1,"message":"296","line":82,"column":6,"nodeType":"268","messageId":"269","endLine":82,"endColumn":18},{"ruleId":"266","severity":1,"message":"297","line":85,"column":6,"nodeType":"268","messageId":"269","endLine":85,"endColumn":15},{"ruleId":"266","severity":1,"message":"298","line":155,"column":15,"nodeType":"268","messageId":"269","endLine":155,"endColumn":33},"no-native-reassign",["354"],"no-negated-in-lhs",["355"],["354"],["355"],"no-unused-vars","'mapDispatchToProp' is defined but never used.","Identifier","unusedVar","'activate' is defined but never used.","'IconButton' is defined but never used.","'ExpandMoreIcon' is defined but never used.","'incrementAmount' is assigned a value but never used.","'setIncrementAmount' is assigned a value but never used.","array-callback-return","Array.prototype.map() expects a value to be returned at the end of arrow function.","ArrowFunctionExpression","expectedAtEnd","'lacuna' is assigned a value but never used.","react/jsx-no-target-blank","Using target=\"_blank\" without rel=\"noreferrer\" is a security risk: see https://html.spec.whatwg.org/multipage/links.html#link-type-noopener","JSXAttribute","no-dupe-class-members","Duplicate name 'renderChr'.","MethodDefinition","unexpected","'logo' is defined but never used.","'Editor' is defined but never used.",["354"],["355"],["354"],["355"],"'decoder' is assigned a value but never used.","'chunk2TableData' is assigned a value but never used.","'input' is assigned a value but never used.","'beginsAtLine' is assigned a value but never used.","'delimiter' is assigned a value but never used.","'webkitRelativePath' is assigned a value but never used.","'render' is defined but never used.","'Tooltip' is defined but never used.","'StarIcon' is defined but never used.","'StarBorderIcon' is defined but never used.","'DoneIcon' is defined but never used.","'WarningIcon' is defined but never used.","'ErrorOutlineIcon' is defined but never used.","'edit' is assigned a value but never used.","'string' is assigned a value but never used.","'value' is assigned a value but never used.","'lastModifiedDate' is assigned a value but never used.","'modified' is assigned a value but never used.","'annotations' is assigned a value but never used.","jsx-a11y/anchor-is-valid","The href attribute is required for an anchor to be keyboard accessible. Provide a valid, navigable address as the href value. If you cannot provide an href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/evcohen/eslint-plugin-jsx-a11y/blob/master/docs/rules/anchor-is-valid.md","JSXOpeningElement","'C' is defined but never used.","'surfaces' is assigned a value but never used.","'Zoom' is defined but never used.","'makeStyles' is defined but never used.",["354"],["355"],"'listErrors' is assigned a value but never used.","'listWarnings' is assigned a value but never used.","no-useless-constructor","Useless constructor.","noUselessConstructor","'dataKey' is assigned a value but never used.","'R' is defined but never used.","'Fade' is defined but never used.","'modify' is defined but never used.","'add' is defined but never used.","'remove' is defined but never used.","'undo' is defined but never used.","'redo' is defined but never used.","'dataActiveKeys' is assigned a value but never used.","'dataLoaderTimeouts' is assigned a value but never used.","'activeTextRow' is assigned a value but never used.","'ATFMap' is assigned a value but never used.","'download' is assigned a value but never used.","'logReducerData' is defined but never used.","no-sequences","Unexpected use of comma operator.","SequenceExpression","unexpectedCommaExpression",["354"],["355"],"'zoom' is assigned a value but never used.","'ReactDOM' is defined but never used.","'useSelector' is defined but never used.","'useDispatch' is defined but never used.","'ChrEditPanel' is defined but never used.","'actions' is assigned a value but never used.","'dispatch' is assigned a value but never used.","'infoButton' is assigned a value but never used.","no-global-assign","no-unsafe-negation"]